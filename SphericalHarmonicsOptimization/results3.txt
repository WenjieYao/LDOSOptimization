#1 rho_s 
#2 coeffs 
old mesh
double lambda_0 = 400;                          // wavelength in unit of nm
const unsigned int num_coeffs = 5*5+1;           // number of coefficients
double k_0 = 2*pi/lambda_0;                     // wavenumber in unit of 1/nm
cdouble Chi = 0;                                // chi = epsilon-1
double d_min = 20;                             // minimum distance in unit of nm
int min_mesh = 2000;
int max_mesh = 6000;
double resolution = 20.0;                        // resolution, larger the finer, default 1

x0[2] = 0.7;
  //x0[0] = 0.0;
  //x0[8] = 1.0;
  double rhos = myfunc(x0,grad0);
  double ng = 0;
  double step = rhos/100;

18.804 0.02 0 0 0.7 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
18.9575 0.02 -8.95732e-07 -4.71282e-06 0.70074 -1.93876e-06 -5.97452e-06 -6.32593e-07 7.22748e-07 5.05013e-07 2.03991e-06 -1.18414e-05 -2.09385e-06 4.48432e-06 -0.000907779 2.63459e-06 -1.4607e-06 -5.51055e-06 -3.84802e-06 -1.30139e-06 5.20828e-06 1.27174e-06 -4.97788e-07 -3.58672e-07 -1.6926e-06 1.30162e-06 1.38947e-06 
19.2088 0.02 -1.79146e-06 -9.42564e-06 0.70148 -3.87752e-06 -1.1949e-05 -1.26519e-06 1.4455e-06 1.01003e-06 4.07983e-06 -2.36829e-05 -4.1877e-06 8.96863e-06 -0.00181556 5.26917e-06 -2.9214e-06 -1.10211e-05 -7.69604e-06 -2.60279e-06 1.04166e-05 2.54347e-06 -9.95576e-07 -7.17344e-07 -3.38521e-06 2.60324e-06 2.77894e-06 
19.3845 0.02 -2.68719e-06 -1.41385e-05 0.70222 -5.81628e-06 -1.79235e-05 -1.89778e-06 2.16824e-06 1.51504e-06 6.11974e-06 -3.55243e-05 -6.28155e-06 1.34529e-05 -0.00272334 7.90376e-06 -4.3821e-06 -1.65317e-05 -1.15441e-05 -3.90418e-06 1.56248e-05 3.81521e-06 -1.49336e-06 -1.07602e-06 -5.07781e-06 3.90486e-06 4.16841e-06 
19.4579 0.02 -3.58293e-06 -1.88513e-05 0.70296 -7.75504e-06 -2.38981e-05 -2.53037e-06 2.89099e-06 2.02005e-06 8.15965e-06 -4.73658e-05 -8.3754e-06 1.79373e-05 -0.00363112 1.05383e-05 -5.84281e-06 -2.20422e-05 -1.53921e-05 -5.20557e-06 2.08331e-05 5.08695e-06 -1.99115e-06 -1.43469e-06 -6.77041e-06 5.20648e-06 5.55788e-06 
19.7081 0.0200003 -4.47866e-06 -2.35641e-05 0.7037 -9.6938e-06 -2.98726e-05 -3.16296e-06 3.61374e-06 2.52506e-06 1.01996e-05 -5.92072e-05 -1.04693e-05 2.24216e-05 -0.00453889 1.31729e-05 -7.30351e-06 -2.75528e-05 -1.92401e-05 -6.50697e-06 2.60414e-05 6.35868e-06 -2.48894e-06 -1.79336e-06 -8.46302e-06 6.5081e-06 6.94735e-06 
19.9263 0.0200003 -5.37439e-06 -2.82769e-05 0.70444 -1.16326e-05 -3.58471e-05 -3.79556e-06 4.33649e-06 3.03008e-06 1.22395e-05 -7.10486e-05 -1.25631e-05 2.69059e-05 -0.00544667 1.58075e-05 -8.76421e-06 -3.30633e-05 -2.30881e-05 -7.80836e-06 3.12497e-05 7.63042e-06 -2.98673e-06 -2.15203e-06 -1.01556e-05 7.80972e-06 8.33682e-06 
20.1296 0.0200003 -6.27012e-06 -3.29897e-05 0.70518 -1.35713e-05 -4.18216e-05 -4.42815e-06 5.05924e-06 3.53509e-06 1.42794e-05 -8.28901e-05 -1.4657e-05 3.13902e-05 -0.00635445 1.84421e-05 -1.02249e-05 -3.85739e-05 -2.69361e-05 -9.10975e-06 3.64579e-05 8.90216e-06 -3.48452e-06 -2.51071e-06 -1.18482e-05 9.11134e-06 9.72629e-06 
20.3488 0.0200003 -7.16585e-06 -3.77026e-05 0.70592 -1.55101e-05 -4.77961e-05 -5.06074e-06 5.78198e-06 4.0401e-06 1.63193e-05 -9.47315e-05 -1.67508e-05 3.58745e-05 -0.00726223 2.10767e-05 -1.16856e-05 -4.40844e-05 -3.07842e-05 -1.04111e-05 4.16662e-05 1.01739e-05 -3.9823e-06 -2.86938e-06 -1.35408e-05 1.0413e-05 1.11158e-05 
20.5766 0.0200003 -8.06158e-06 -4.24154e-05 0.706659 -1.74488e-05 -5.37706e-05 -5.69333e-06 6.50473e-06 4.54511e-06 1.83592e-05 -0.000106573 -1.88447e-05 4.03588e-05 -0.00817001 2.37113e-05 -1.31463e-05 -4.9595e-05 -3.46322e-05 -1.17125e-05 4.68745e-05 1.14456e-05 -4.48009e-06 -3.22805e-06 -1.52334e-05 1.17146e-05 1.25052e-05 
20.8261 0.0200003 -8.95732e-06 -4.71282e-05 0.707399 -1.93876e-05 -5.97452e-05 -6.32593e-06 7.22748e-06 5.05013e-06 2.03991e-05 -0.000118414 -2.09385e-05 4.48432e-05 -0.00907779 2.63459e-05 -1.4607e-05 -5.51055e-05 -3.84802e-05 -1.30139e-05 5.20828e-05 1.27174e-05 -4.97788e-06 -3.58672e-06 -1.6926e-05 1.30162e-05 1.38947e-05 
20.9995 0.0200003 -9.85305e-06 -5.1841e-05 0.708139 -2.13264e-05 -6.57197e-05 -6.95852e-06 7.95023e-06 5.55514e-06 2.2439e-05 -0.000130256 -2.30324e-05 4.93275e-05 -0.00998557 2.89805e-05 -1.60677e-05 -6.06161e-05 -4.23282e-05 -1.43153e-05 5.72911e-05 1.39891e-05 -5.47567e-06 -3.94539e-06 -1.86186e-05 1.43178e-05 1.52842e-05 
21.1697 0.0200003 -1.07488e-05 -5.65538e-05 0.708879 -2.32651e-05 -7.16942e-05 -7.59111e-06 8.67297e-06 6.06015e-06 2.4479e-05 -0.000142097 -2.51262e-05 5.38118e-05 -0.0108933 3.1615e-05 -1.75284e-05 -6.61266e-05 -4.61762e-05 -1.56167e-05 6.24993e-05 1.52608e-05 -5.97346e-06 -4.30407e-06 -2.03112e-05 1.56194e-05 1.66736e-05 
21.4111 0.0200003 -1.16445e-05 -6.12667e-05 0.709619 -2.52039e-05 -7.76687e-05 -8.2237e-06 9.39572e-06 6.56516e-06 2.65189e-05 -0.000153939 -2.72201e-05 5.82961e-05 -0.0118011 3.42496e-05 -1.89891e-05 -7.16372e-05 -5.00243e-05 -1.69181e-05 6.77076e-05 1.65326e-05 -6.47124e-06 -4.66274e-06 -2.20038e-05 1.69211e-05 1.80631e-05 
21.5527 0.0200003 -1.25402e-05 -6.59795e-05 0.710359 -2.71426e-05 -8.36432e-05 -8.8563e-06 1.01185e-05 7.07018e-06 2.85588e-05 -0.00016578 -2.93139e-05 6.27804e-05 -0.0127089 3.68842e-05 -2.04498e-05 -7.71477e-05 -5.38723e-05 -1.82195e-05 7.29159e-05 1.78043e-05 -6.96903e-06 -5.02141e-06 -2.36964e-05 1.82227e-05 1.94526e-05 
21.9404 0.0200004 -1.3436e-05 -7.06923e-05 0.711099 -2.90814e-05 -8.96177e-05 -9.48889e-06 1.08412e-05 7.57519e-06 3.05987e-05 -0.000177622 -3.14078e-05 6.72647e-05 -0.0136167 3.95188e-05 -2.19105e-05 -8.26583e-05 -5.77203e-05 -1.95209e-05 7.81242e-05 1.9076e-05 -7.46682e-06 -5.38008e-06 -2.5389e-05 1.95243e-05 2.0842e-05 
22.1381 0.0200004 -1.43317e-05 -7.54051e-05 0.711839 -3.10202e-05 -9.55923e-05 -1.01215e-05 1.1564e-05 8.0802e-06 3.26386e-05 -0.000189463 -3.35016e-05 7.17491e-05 -0.0145245 4.21534e-05 -2.33712e-05 -8.81688e-05 -6.15683e-05 -2.08223e-05 8.33324e-05 2.03478e-05 -7.96461e-06 -5.73875e-06 -2.70816e-05 2.08259e-05 2.22315e-05 
